<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Shree Ji Tech | Enterprise</title>

<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

<style>
:root{
--red:#ff4d6d;
--green:#22c55e;
--bg:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
--glass:rgba(255,255,255,0.05);
}
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',sans-serif}
body{background:var(--bg);color:white;padding-bottom:120px}
header{background:rgba(0,0,0,.4);padding:12px;display:flex;justify-content:space-between;align-items:center}
.logo-area{display:flex;align-items:center;gap:10px}
.logo-area img{height:50px;width:50px;border-radius:50%;border:2px solid var(--red)}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:15px;padding:15px}
.card{background:var(--glass);padding:15px;border-radius:16px;text-align:center}
.card img{height:90px;width:100%;object-fit:contain}
.price{color:var(--green);font-weight:bold;margin:5px 0}
.btn{background:linear-gradient(45deg,var(--red),#ff758f);border:none;padding:10px;border-radius:10px;color:white;font-weight:bold;margin:4px 0;width:100%;cursor:pointer}
input{width:100%;padding:10px;margin:6px 0;border-radius:8px;border:none;background:#1e293b;color:white}
.modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.7);align-items:center;justify-content:center;z-index:999}
.box{background:#111827;padding:20px;border-radius:16px;width:90%;max-width:400px}
.login-icon{cursor:pointer;font-size:22px}
</style>
</head>
<body>

<header>
<div class="logo-area">
<img src="1000007701.jpg">
<div>
<b>SHREE JI TECH</b>
<p id="welcomeMsg" style="font-size:10px">Welcome Guest</p>
</div>
</div>

<div>
<span class="login-icon" onclick="showModal('loginModal')">ðŸ‘¤</span>
<button id="logoutBtn" class="btn" style="display:none;background:#444;width:auto" onclick="logoutUser()">Logout</button>
<button id="adminBtn" class="btn" style="display:none;width:auto" onclick="showModal('adminPanel')">Admin</button>
</div>
</header>

<div class="grid" id="productGrid"></div>

<!-- LOGIN MODAL -->
<div id="loginModal" class="modal">
<div class="box">
<h3>Mobile Login</h3>
<input id="phone" value="+91" onfocus="if(this.value=='+91')this.setSelectionRange(3,3)">
<input id="password" type="password" placeholder="Enter / Set Password">
<button class="btn" onclick="handleAuth()">Continue</button>
<button class="btn" style="background:#444" onclick="closeModal('loginModal')">Close</button>
</div>
</div>

<!-- ADMIN PANEL -->
<div id="adminPanel" class="modal">
<div class="box">
<h3>Add Product</h3>
<input id="pName" placeholder="Name">
<input id="pPrice" type="number" placeholder="Price">
<input id="pImg" placeholder="Image URL">
<button class="btn" onclick="saveProduct()">Save</button>
<div id="orderList"></div>
<button class="btn" style="background:#444" onclick="closeModal('adminPanel')">Close</button>
</div>
</div>

<script>
firebase.initializeApp({
apiKey:"AIzaSyBuCywyMgEw_j9yeHD-E4KwRWZGreWagTc",
authDomain:"shree-4c33e.firebaseapp.com",
projectId:"shree-4c33e"
});

const db=firebase.firestore();
const ADMIN_NUMBER="7052055713";

let currentUser=null;

/* AUTH STATE */
firebase.auth().onAuthStateChanged(user=>{
if(user){
currentUser=user;
let number=user.email.replace("@shreeji.com","");
welcomeMsg.innerText="Logged in: +91"+number;
logoutBtn.style.display="inline-block";

if(number===ADMIN_NUMBER){
adminBtn.style.display="inline-block";
loadOrders();
}
}
loadProducts();
});

/* MOBILE LOGIN SYSTEM */
function handleAuth(){

let phone=document.getElementById("phone").value.trim();
let pass=document.getElementById("password").value.trim();

if(!phone.startsWith("+91") || phone.length<13){
alert("Enter valid number");
return;
}

let number=phone.replace("+91","");
let email=number+"@shreeji.com";

firebase.auth().fetchSignInMethodsForEmail(email)
.then(methods=>{

if(methods.length===0){
// Register
firebase.auth().createUserWithEmailAndPassword(email,pass)
.then(()=>alert("Account Created"))
.catch(e=>alert(e.message));
}
else{
// Login
firebase.auth().signInWithEmailAndPassword(email,pass)
.catch(()=>alert("Wrong Password"));
}

});
}

function logoutUser(){
firebase.auth().signOut();
location.reload();
}

/* PRODUCTS */
function loadProducts(){
db.collection("products").onSnapshot(s=>{
productGrid.innerHTML="";
s.forEach(doc=>{
let p=doc.data();
productGrid.innerHTML+=`
<div class="card">
<img src="${p.img||''}">
<p>${p.name}</p>
<div class="price">â‚¹${p.price}</div>
</div>`;
});
});
}

function saveProduct(){
db.collection("products").add({
name:pName.value,
price:Number(pPrice.value),
img:pImg.value,
date:Date.now()
});
alert("Product Added");
}

/* ADMIN ORDERS */
function loadOrders(){
db.collection("orders").onSnapshot(s=>{
orderList.innerHTML="<h4>All Orders</h4>";
s.forEach(doc=>{
let o=doc.data();
orderList.innerHTML+=`
<div style="background:#1e293b;padding:8px;margin:5px 0;border-radius:8px;font-size:12px">
ðŸ†” ${o.orderId}<br>
ðŸ‘¤ ${o.customerName}<br>
ðŸ’° â‚¹${o.price}<br>
Status: ${o.status}
</div>`;
});
});
}

function showModal(id){document.getElementById(id).style.display="flex"}
function closeModal(id){document.getElementById(id).style.display="none"}
</script>

</body>
</html>
