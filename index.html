<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Shree Ji Tech | Enterprise</title>

<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics-compat.js"></script>
<script src="https://checkout.razorpay.com/v1/checkout.js"></script>

<style>
:root{
--red:#ff4d6d;
--green:#22c55e;
--bg:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
--glass:rgba(255,255,255,0.05);
}

*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',sans-serif}
body{background:var(--bg);color:white;padding-bottom:120px}

header{
background:rgba(0,0,0,0.4);
backdrop-filter:blur(10px);
padding:12px;
display:flex;
justify-content:space-between;
align-items:center;
}

.logo-area{display:flex;align-items:center;gap:10px}
.logo-area img{
height:50px;width:50px;border-radius:50%;
border:2px solid var(--red);
box-shadow:0 0 10px var(--red);
}

.grid{display:grid;grid-template-columns:1fr 1fr;gap:15px;padding:15px}

.card{
background:var(--glass);
backdrop-filter:blur(12px);
border-radius:16px;
padding:15px;
text-align:center;
box-shadow:0 10px 25px rgba(0,0,0,.4);
}

.card img{height:90px;width:100%;object-fit:contain;margin-bottom:10px}

.price{font-weight:bold;font-size:18px;color:var(--green);margin:6px 0}

.btn{
background:linear-gradient(45deg,var(--red),#ff758f);
border:none;
padding:10px;
border-radius:10px;
color:white;
font-weight:bold;
cursor:pointer;
margin:4px 0;
width:100%;
}

input{
width:100%;
padding:10px;
margin:6px 0;
border-radius:8px;
border:none;
background:#1e293b;
color:white;
}

.modal{
display:none;
position:fixed;
inset:0;
background:rgba(0,0,0,.7);
align-items:center;
justify-content:center;
z-index:999;
}

.box{
background:#111827;
padding:20px;
border-radius:16px;
width:90%;
max-width:400px;
}

.bottom-nav{
position:fixed;
bottom:0;
width:100%;
background:rgba(0,0,0,.6);
display:flex;
justify-content:space-around;
padding:12px 0;
}

.nav-item{font-size:12px;text-align:center;cursor:pointer}

.order-card{
background:#1e293b;
padding:10px;
border-radius:10px;
margin-bottom:10px;
font-size:12px;
}
</style>
</head>

<body>

<header>
<div class="logo-area">
<img src="1000007701.jpg">
<div>
<b>SHREE JI TECH</b>
<p id="welcomeMsg" style="font-size:10px">Welcome Guest</p>
</div>
</div>
<div>
<button id="logoutBtn" class="btn" style="display:none;background:#444;width:auto" onclick="logoutUser()">Logout</button>
<button id="addBtn" class="btn" style="display:none;width:auto" onclick="showModal('adminPanel')">‚ûï</button>
</div>
</header>

<!-- LOGIN BOX -->
<div id="loginBox" style="padding:15px;text-align:center">
<input id="phoneNumber" placeholder="+91XXXXXXXXXX">
<div id="recaptcha-container"></div>
<button class="btn" onclick="sendOTP()">Send OTP</button>
<input id="otpBox" placeholder="Enter OTP">
<button class="btn" onclick="verifyOTP()">Verify OTP</button>
</div>

<div class="grid" id="productGrid"></div>

<!-- ADMIN PANEL -->
<div id="adminPanel" class="modal">
<div class="box">
<h3>Add / Edit Product</h3>
<input id="pName" placeholder="Name">
<input id="pPrice" type="number" placeholder="Price">
<input id="pImg" placeholder="Image URL">
<button class="btn" onclick="saveProduct()">Save</button>
<hr>
<h3>All Orders</h3>
<div id="orderList"></div>
<button class="btn" onclick="closeModal('adminPanel')" style="background:#444">Close</button>
</div>
</div>

<!-- MY ORDERS -->
<div id="myOrdersModal" class="modal">
<div class="box">
<h3>My Orders</h3>
<div id="myOrdersList"></div>
<button class="btn" onclick="closeModal('myOrdersModal')" style="background:#444">Close</button>
</div>
</div>

<div class="bottom-nav">
<div class="nav-item" onclick="location.reload()">üè†<br>Home</div>
<div class="nav-item" onclick="showMyOrders()">üì¶<br>Orders</div>
</div>

<script>
firebase.initializeApp({
apiKey: "AIzaSyBuCywyMgEw_j9yeHD-E4KwRWZGreWagTc",
authDomain: "shree-4c33e.firebaseapp.com",
projectId: "shree-4c33e",
storageBucket: "shree-4c33e.firebasestorage.app",
messagingSenderId: "759128544690",
appId: "1:759128544690:web:3f57e7ed9117a1acdd80ab",
measurementId: "G-NP1D792NVF"
});

firebase.analytics();
const db=firebase.firestore();
const ADMIN="+917052055713";
let editId=null;

/* LOGIN SYSTEM */
firebase.auth().useDeviceLanguage();
window.recaptchaVerifier=new firebase.auth.RecaptchaVerifier('recaptcha-container',{size:'normal'});

function sendOTP(){
firebase.auth().signInWithPhoneNumber(phoneNumber.value,window.recaptchaVerifier)
.then(res=>{window.confirmationResult=res;alert("OTP Sent");})
.catch(e=>alert(e.message));
}

function verifyOTP(){
confirmationResult.confirm(otpBox.value)
.then(res=>{
localStorage.setItem("userPhone",res.user.phoneNumber);
location.reload();
})
.catch(()=>alert("Wrong OTP"));
}

/* LOAD DATA */
function loadData(){
let user=localStorage.getItem("userPhone");
if(user){
welcomeMsg.innerText="Logged in: "+user;
loginBox.style.display="none";
logoutBtn.style.display="block";
if(user===ADMIN){
addBtn.style.display="block";
loadOrders();
}
}

db.collection("products").onSnapshot(s=>{
productGrid.innerHTML="";
s.forEach(doc=>{
let p=doc.data();
let adminBtns="";
if(user===ADMIN){
adminBtns=`
<button class="btn" onclick="editProduct('${doc.id}','${p.name}',${p.price},'${p.img}')">Edit</button>
<button class="btn" style="background:#000" onclick="deleteProduct('${doc.id}')">Delete</button>`;
}
productGrid.innerHTML+=`
<div class="card">
<img src="${p.img||''}">
<p>${p.name}</p>
<div class="price">‚Çπ${p.price}</div>
<button class="btn" onclick="orderNow('${doc.id}')">Cash Order</button>
<button class="btn" style="background:green" onclick="payNow('${doc.id}')">Pay Now</button>
${adminBtns}
</div>`;
});
});
}

/* PRODUCT CRUD */
function saveProduct(){
if(editId){
db.collection("products").doc(editId).update({
name:pName.value,
price:Number(pPrice.value),
img:pImg.value
}).then(()=>{editId=null;closeModal("adminPanel");});
}else{
db.collection("products").add({
name:pName.value,
price:Number(pPrice.value),
img:pImg.value,
date:Date.now()
}).then(()=>closeModal("adminPanel"));
}
}

function editProduct(id,name,price,img){
editId=id;
pName.value=name;
pPrice.value=price;
pImg.value=img;
showModal("adminPanel");
}

function deleteProduct(id){
if(confirm("Delete?")) db.collection("products").doc(id).delete();
}

/* ORDERS */
function orderNow(id){
let user=localStorage.getItem("userPhone");
if(!user){alert("Login Required");return;}

db.collection("products").doc(id).get().then(doc=>{
let p=doc.data();
db.collection("orders").add({
user,item:p.name,price:p.price,status:"Pending",date:Date.now()
});
alert("Order Placed");
});
}

function payNow(id){
let user=localStorage.getItem("userPhone");
if(!user){alert("Login Required");return;}

db.collection("products").doc(id).get().then(doc=>{
let p=doc.data();
new Razorpay({
key:"YOUR_RAZORPAY_KEY",
amount:p.price*100,
currency:"INR",
name:"Shree Ji Tech",
description:p.name,
handler:function(res){
db.collection("orders").add({
user,item:p.name,price:p.price,status:"Paid",
paymentId:res.razorpay_payment_id,
date:Date.now()
});
alert("Payment Successful");
}
}).open();
});
}

function loadOrders(){
db.collection("orders").onSnapshot(s=>{
orderList.innerHTML="";
s.forEach(doc=>{
let o=doc.data();
orderList.innerHTML+=`
<div class="order-card">
üë§ ${o.user}<br>
üì¶ ${o.item}<br>
üí∞ ‚Çπ${o.price}<br>
üü° ${o.status}
</div>`;
});
});
}

function showMyOrders(){
let user=localStorage.getItem("userPhone");
if(!user){alert("Login Required");return;}

db.collection("orders").where("user","==",user)
.onSnapshot(s=>{
myOrdersList.innerHTML="";
s.forEach(doc=>{
let o=doc.data();
myOrdersList.innerHTML+=`
<div class="order-card">
üì¶ ${o.item}<br>
üí∞ ‚Çπ${o.price}<br>
üü° ${o.status}
</div>`;
});
});
showModal("myOrdersModal");
}

function logoutUser(){
localStorage.removeItem("userPhone");
firebase.auth().signOut();
location.reload();
}

function showModal(id){document.getElementById(id).style.display="flex"}
function closeModal(id){document.getElementById(id).style.display="none"}

window.onload=loadData;
</script>

</body>
</html>
